{% load widget_tweaks %}
{% load custom_tags %}
<div id="profile_posts_page" data-pageurl="{{current_url}}?page={{current_page.number}}" data-firstpage="{{current_url}}" data-option-selected={{option}} >
  <div class="page-header" id="profile_posts_page_header">
    <h4><span id="profile_posts_count">{{posts_count}}</span> {{ title }}</h4>
  </div>

  <div><span>Sort by: </span>
  <select id="profile_posts_select">
    <option class="filter_button" value="1" selected="selected">By date created</option>
    <option class="filter_button" value="2">By date edited</option>
    <option class="filter_button" value="3">By date published</option>
    <option class="filter_button" value="4">By likes</option>
    <option class="filter_button" value="5">By dislikes</option>
      <option class="filter_button" value="6">By comments</option>

  </select>
  </div>

  <div>
    <a class="btn btn-primary" href="{% url 'posts:post_create' %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Write</a>
  </div>

  {% if no_posts == True %}
  <div>
    <p>There are no posts.</p>
  </div>

  {% else %}
  <div>
    {% for post in current_page %}
    <div class="thumbnail thumbnail_container" data-id="{{post.id}}" data-url="{{post.get_absolute_url}}" >
      <div class="caption">
        <p><a href="{{ post.category.get_absolute_url }}">{{ post.category }}</a></p>
        <h3><a href="{{ post.get_absolute_url }}">{{ post.title }}</a></h3>
        <p><a href="{% url 'profiles:profile_activity' id=user.id slug=user.profile.slug %}">{{ post.user.username }}</a></p>
        <p>{{ post.content }}</p>
        <p>created {{ post.date_created }}</p>
        <p>published {{ post.date_published }}</p>

        <p><a href="{{ post.get_absolute_url }}" data-toggle="tooltip" data-placement="top" title="Published {{ post.date_published }}">Edited {{ post.date_edited }}</a></p>
        <p>
          <button type="button" class="btn btn-primary like_button"  {% if is_user == True %}disabled="disabled"{% endif %} data-liked="False"}><span class="glyphicon glyphicon-thumbs-up" aria-hidden="true"></span> {{ post.likes }}</button>
          <button type="button" class="btn btn-link dislike_button"  {% if is_user == True %}disabled="disabled"{% endif %} data-disliked="False"><span class="glyphicon glyphicon-thumbs-down" aria-hidden="true"></span> {{ post.dislikes }}</button>
          <button type="button" class="btn btn-link comment_button" id="comment_button_{{post.id}}" ><span class="glyphicon glyphicon-comment" aria-hidden="true"></span> {{ comments_count|index:forloop.counter0 }}</button>
          <button type="button" class="btn btn-link" ><span class="glyphicon glyphicon-share" aria-hidden="true"></span> Share</button>
          <button type="button" class="btn btn-link bookmark_button"><span class="glyphicon glyphicon-bookmark" aria-hidden="true"></span> Bookmark</button>
        </p>
        <p>
          <div class="collapse profile_comments_page" id="profile_comments_page_{{post.id}}"  ></div>
        </p>
        {% if is_user %}
        <p>
          <a href="{% url 'posts:post_edit' id=post.id slug=post.slug %}">Edit</a>
          <!-- Button trigger modal -->
          <button type="button" class="btn btn-link delete_button">Delete</button>

          <!-- Modal -->
          <div class="modal fade" id="profile_posts_modal_{{ post.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
            <div class="modal-dialog" role="document">
              <div class="modal-content">
                <div class="modal-header">
                  <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                  <h4 class="modal-title" id="myModalLabel">Delete Post</h4>
                </div>
                <div class="modal-body">
                  <p>Are you sure you wish to delete this post?</p>
                </div>
                <div class="modal-footer">
                  <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                  <button type="button" class="btn btn-default confirm_delete_button">Confirm</button>
                </div>
              </div>
            </div>
          </div>
        </p>
        {% endif %}
      </div>
    </div>
    {% endfor %}
  </div>

  <div>
    <ul class="pagination">
      {% if current_page.has_previous %}
      <li><a class="profile_posts_page_button" href="?page={{ current_page.previous_page_number }}">&laquo;</a></li>
      {% else %}
      <li class="disabled"><span>&laquo;</span></li>
      {% endif %}
      {% for i in current_page.paginator.page_range %}
      {% if current_page.number == i %}
      <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
      {% else %}
      <li><a class="profile_posts_page_button" href="?page={{ i }}">{{ i }}</a></li>
      {% endif %}
      {% endfor %}
      {% if current_page.has_next %}
      <li><a class="profile_posts_page_button" href="?page={{ current_page.next_page_number }}">&raquo;</a></li>
      {% else %}
      <li class="disabled"><span>&raquo;</span></li>
      {% endif %}
    </ul>
  </div>
  {% endif %}
</div>
