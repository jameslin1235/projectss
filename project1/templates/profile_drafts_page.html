{% load widget_tweaks %}

<div id="profile_drafts_page" data-draft-current-page="{{current_url}}?page={{current_page.number}}" data-draft-first-page="{{current_url}}" data-option-selected={{option}} >
<div class="page-header" id="profile_drafts_page_header">
  <h4><span id="profile_drafts_count">{{drafts_count}}</span> {{ title }}</h4>
</div>

<div><span>Sort by: </span>
<select id="profile_drafts_select">
  <option class="filter_button" value="1" selected="selected">By date created</option>
  <option class="filter_button" value="2">By date edited</option>

</select>
</div>
{% if messages %}
{% for message in messages %}
<div class="alert alert-{{ message.tags }} alert-dismissible" role="alert">
  <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
  <strong>{{ message }}</strong>
</div>
{% endfor %}
{% endif %}

<div>
  <a class="btn btn-primary" href="{% url 'posts:post_create' %}"><span class="glyphicon glyphicon-pencil" aria-hidden="true"></span> Write</a>
</div>

{% if no_drafts == True %}
<div>
  <p>There are no drafts.</p>
</div>

{% else %}
<div>
  {% for draft in current_page %}
  <div class="thumbnail draft_container" data-id="{{draft.id}}" data-url="{{draft.get_absolute_url}}" >
    <div class="caption">
      <p><a href="{{ draft.category.get_absolute_url }}">{{ draft.category }}</a></p>
      <h3><a href="{% url 'posts:post_edit' id=draft.id slug=draft.slug %}">{{ draft.title }}</a></h3>
      <p><a href="{% url 'profiles:profile_activity' id=user.id slug=user.profile.slug %}">{{ draft.user.username }}</a></p>
      <p>{{ draft.content }}</p>
      <p><a href="{{ draft.get_absolute_url }}"  title="Published {{ draft.date_published }}">Edited {{ draft.date_edited }}</a></p>
      <p><a href="{{ draft.get_absolute_url }}"  title="Published {{ draft.date_published }}">Created {{ draft.date_created}}</a></p>
      <p><a href="{{ draft.get_absolute_url }}"  title="Published {{ draft.date_published }}">Created {{ draft.date_created}}</a></p>

      <p>
        <a href="{% url 'posts:post_edit' id=draft.id slug=draft.slug %}">Edit</a>
        <!-- Button trigger modal -->
        <button type="button" class="btn btn-link delete_button">Delete</button>
        <button type="button" class="btn btn-link publish_button">Publish</button>



        <!-- Modal -->
        <div class="modal fade" id="profile_drafts_delete_modal_{{ draft.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Delete Draft</h4>
              </div>
              <div class="modal-body">
                <p>Are you sure you wish to delete this draft?</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-default confirm_delete_button">Confirm</button>
              </div>
            </div>
          </div>
        </div>

        <!-- Modal -->
        <div class="modal fade" id="profile_drafts_publish_modal_{{ draft.id }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel">
          <div class="modal-dialog" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <h4 class="modal-title" id="myModalLabel">Publish Draft</h4>
              </div>
              <div class="modal-body">
                <p>Are you sure you wish to publish this draft?</p>
              </div>
              <div class="modal-footer">
                <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                <button type="button" class="btn btn-default confirm_publish_button">Confirm</button>
              </div>
            </div>
          </div>
        </div>
      </p>

    </div>
  </div>
  {% endfor %}
</div>

<div>
  <ul class="pagination">
    {% if current_page.has_previous %}
    <li><a class="profile_drafts_page_button" href="?page={{ current_page.previous_page_number }}">&laquo;</a></li>
    {% else %}
    <li class="disabled"><span>&laquo;</span></li>
    {% endif %}
    {% for i in current_page.paginator.page_range %}
    {% if current_page.number == i %}
    <li class="active"><span>{{ i }} <span class="sr-only">(current)</span></span></li>
    {% else %}
    <li><a class="profile_drafts_page_button" href="?page={{ i }}">{{ i }}</a></li>
    {% endif %}
    {% endfor %}
    {% if current_page.has_next %}
    <li><a class="profile_drafts_page_button" href="?page={{ current_page.next_page_number }}">&raquo;</a></li>
    {% else %}
    <li class="disabled"><span>&raquo;</span></li>
    {% endif %}
  </ul>
</div>
{% endif %}
</div>
